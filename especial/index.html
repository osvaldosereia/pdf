<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    
    <!-- SEO: Canonical Tag -->
    <link rel="canonical" href="https://donaantonia.com.br/" />

    <!-- OTIMIZA√á√ÉO: Preconnect e DNS-Prefetch -->
    <link rel="preconnect" href="https://www.googletagmanager.com">
    <link rel="dns-prefetch" href="https://www.googletagmanager.com">
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    <link rel="dns-prefetch" href="https://cdnjs.cloudflare.com">
    <link rel="preconnect" href="https://maps.google.com">
    
    <!-- PWA -->
    <link rel="manifest" href="manifest.json">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Dona Ant√¥nia">
    <link rel="apple-touch-icon" href="img/logo-super-cesta-basica-dona-antonia-cuiaba-varzea-grande.avif">
    <link rel="shortcut icon" href="img/logo-super-cesta-basica-dona-antonia-cuiaba-varzea-grande.avif">

    <title>Monte sua Cesta | Dona Ant√¥nia</title>
    
    <meta name="description" content="Monte sua cesta b√°sica personalizada em Cuiab√°. Escolha os itens e receba em casa.">
    <meta name="keywords" content="cesta b√°sica personalizada, mercado online cuiab√°, compras online">
    
    <meta property="og:locale" content="pt_BR" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Monte sua Cesta - Dona Ant√¥nia" />
    <meta property="og:description" content="Escolha seus produtos e monte a cesta ideal para sua fam√≠lia." />
    <meta property="og:url" content="https://donaantonia.com.br/" />
    <meta property="og:image" content="https://donaantonia.com.br/img/logo-super-cesta-basica-dona-antonia-cuiaba-varzea-grande.avif" />
    <meta property="og:site_name" content="Dona Ant√¥nia Alimentos" />

    <meta name="geo.region" content="BR-MT" />
    <meta name="geo.placename" content="Cuiab√°" />
    <meta name="geo.position" content="-15.6025;-56.0968" />
    <meta name="ICBM" content="-15.6025, -56.0968" />

    <meta name="robots" content="index, follow">
    <meta name="author" content="Super Cestas B√°sicas Dona Ant√¥nia">
    <meta name="theme-color" content="#0F2546"> 
    
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" as="style">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" media="print" onload="this.media='all'">
    <noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"></noscript>
    
    <style>
        /* === ESTILOS GLOBAIS E TIPOGRAFIA === */
        * { box-sizing: border-box; }

        :root {
            --cor-primaria: #0F2546; 
            --cor-destaque-vermelho: #D32F2F; 
            --cor-destaque-dourado: #FFC107; 
            --cor-whatsapp: #128C7E; 
            --cor-info: #1565C0; 
            --cor-texto: #333; 
            --cor-fundo: #fafafa;
            --cor-pagamento: #0277BD; 
            --cor-sorteio: #2E7D32; 
            --cor-entrega: #EF6C00; 
            --cor-header-fundo: #f5f5f5;
            --altura-header: 80px; 
            --largura-logo: 100px; 
        }

        html { 
            background-color: #e0e0e0; 
            scroll-behavior: smooth;
            scroll-padding-top: calc(var(--altura-header) + 40px); 
            font-size: 15px;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        body {
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif; 
            background-color: #e0e0e0; 
            color: var(--cor-texto);
            margin: 0; 
            padding: 0;
            padding-top: calc(var(--altura-header) + 10px); 
            padding-bottom: 90px; 
            min-height: 10vh;
            position: relative; 
            width: 100%;
            line-height: 1.5; 
        }

        h1, h2, h3, h4, h5, h6 {
            color: var(--cor-primaria);
            margin-top: 0;
            line-height: 1.2;
        }

        .main-content-wrapper {
            max-width: 480px; 
            margin: 0 auto; 
            background-color: var(--cor-fundo); 
            box-shadow: 0 0 20px rgba(0,0,0,0.05); 
            transition: max-width 0.3s ease; 
        }
        
        .desktop-only { display: none !important; }

        /* === TITULO H1 SEO === */
        .seo-main-title {
            text-align: center;
            padding: 20px 15px 10px 15px;
            background: #fff;
        }
        .seo-main-title h1 {
            font-size: 1.25rem; 
            font-weight: 700; 
            margin: 0;
            letter-spacing: -0.5px;
        }
        .seo-main-title p {
            font-size: 0.95rem;
            color: #666;
            margin: 6px 0 0 0;
            font-weight: 400;
        }

        /* --- CABE√áALHO --- */
        header {
            background-color: white;
            height: var(--altura-header);
            padding: 0;
            display: flex;
            flex-direction: row; 
            box-shadow: 0 4px 12px rgba(0,0,0,0.04);
            position: fixed;
            top: 0;
            left: 50%; 
            transform: translateX(-50%); 
            width: 100%;
            max-width: 480px; 
            z-index: 1000;
            transition: max-width 0.3s ease;
            contain: layout size; 
        }

        .header-background-bar {
            position: absolute;
            top: 0;
            left: 50%; 
            transform: translateX(-50%);
            width: 100%;
            max-width: 480px; 
            height: var(--altura-header);
            background-color: var(--cor-header-fundo);
            z-index: 999;
            transition: max-width 0.3s ease;
        }
        
        .header-top {
            display: flex;
            justify-content: flex-end; 
            align-items: center;
            width: 100%;
            height: 100%;
            padding: 5px 15px;
            position: relative;
            z-index: 1002;
        }

        .logo-pequ { 
            height: var(--largura-logo);
            width: var(--largura-logo); 
            object-fit: cover; 
            border-radius: 50%; 
            box-shadow: 0 4px 15px rgba(0,0,0,0.1); 
            position: fixed;
            top: 5px; 
            left: 15px; 
            z-index: 2000; 
            background-color: white;
            padding: 0; 
        }

        .btn-contato-principal {
            display: flex;
            align-items: center;    
            justify-content: center;
            background-color: var(--cor-primaria);
            color: var(--cor-destaque-dourado); 
            border: 1px solid var(--cor-destaque-dourado); 
            border-radius: 50px; 
            padding: 8px 20px; 
            cursor: pointer;
            text-decoration: none;
            box-shadow: 0 4px 10px rgba(15, 37, 70, 0.2);
            margin-left: auto;
            text-align: center;
            max-width: calc(100% - var(--largura-logo) - 10px);
        }

        .linha-destaque-top {
            font-weight: 700;
            font-size: 0.85rem; 
            text-transform: uppercase;
            letter-spacing: 0.5px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        @media (max-width: 380px) {
            :root { --largura-logo: 85px; --altura-header: 75px; }
            .logo-pequ { left: 10px; }
            .linha-destaque-top { font-size: 0.75rem; }
        }

        /* === ESTILOS DA GRADE DE PRODUTOS PERSONALIZADA === */
        .secao-conteudo { padding: 15px; }
        
        .monte-sua-cesta-container {
            padding: 10px;
        }

        .instrucoes-cesta {
            background-color: #E3F2FD;
            color: #1565C0;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-size: 0.9rem;
            text-align: left;
            border: 1px solid #BBDEFB;
        }
        .instrucoes-cesta ul { margin: 10px 0 0 20px; padding: 0; }
        .instrucoes-cesta li { margin-bottom: 5px; }

        .categoria-titulo {
            grid-column: 1 / -1;
            font-size: 1.1rem;
            color: var(--cor-primaria);
            background-color: #e0e0e0;
            padding: 10px 15px;
            border-radius: 8px;
            margin-top: 15px;
            margin-bottom: 5px;
            font-weight: 700;
            text-transform: uppercase;
            border-left: 5px solid var(--cor-destaque-dourado);
        }

        .produtos-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr); /* Mobile: 2 colunas */
            gap: 15px;
        }

        .produto-item {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            border: 1px solid #e0e0e0; /* Borda sutil */
            overflow: hidden;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            transition: transform 0.2s, background-color 0.2s, border-color 0.2s;
        }
        .produto-item:hover {
            border-color: var(--cor-primaria);
        }
        
        /* ESTILO SELECIONADO - FUNDO VERDE CLARO */
        .produto-item.selecionado {
            background-color: #E8F5E9; /* Verde bem claro */
            border-color: #4CAF50; /* Borda verde mais forte */
            box-shadow: 0 4px 8px rgba(76, 175, 80, 0.15);
        }
        /* Garantir que o fundo verde apare√ßa removendo fundos brancos filhos */
        .produto-item.selecionado .prod-img-wrapper,
        .produto-item.selecionado .prod-info {
            background-color: transparent; 
        }

        /* IMAGEM MAIOR NO CARD COMPACTO */
        .prod-img-wrapper {
            width: 100%;
            height: 140px; 
            background-color: #fff;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            padding: 5px;
            transition: background-color 0.2s;
        }
        .prod-img-wrapper img {
            max-width: 95%;
            max-height: 95%;
            object-fit: contain;
        }

        .prod-info {
            padding: 8px; 
            text-align: center;
            background: #fff;
            border-top: 1px solid #f5f5f5;
            transition: background-color 0.2s;
        }

        .prod-nome {
            font-size: 0.8rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 6px;
            min-height: 32px; 
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1.1;
            overflow: hidden;
        }

        .controle-qtd {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
            background-color: #f5f5f5; /* Mantem fundo cinza nos botoes */
            border-radius: 20px;
            padding: 3px; 
        }
        .produto-item.selecionado .controle-qtd {
            background-color: #C8E6C9; /* Fundo mais escuro para controle selecionado */
        }

        .btn-qtd {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            border: none;
            background-color: white;
            color: var(--cor-primaria);
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.1rem;
        }
        .btn-qtd:active { background-color: #ddd; transform: scale(0.95); }
        
        .qtd-display {
            font-weight: 700;
            color: var(--cor-primaria);
            width: 20px;
            text-align: center;
            font-size: 1rem;
        }

        /* BARRA DE A√á√ïES COMPACTA */
        .barra-acoes {
            background-color: white;
            border-top: 1px solid #ddd;
            padding: 10px 15px; /* Reduzi padding */
            position: sticky;
            bottom: 0;
            z-index: 900;
            box-shadow: 0 -4px 15px rgba(0,0,0,0.08);
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        /* ESTILOS DA GAMIFICA√á√ÉO (BARRAS DE PROGRESSO) */
        .gamificacao-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 5px;
            padding-bottom: 10px;
            border-bottom: 1px dashed #eee;
        }
        .meta-texto {
            display: flex;
            justify-content: space-between;
            font-size: 0.75rem;
            margin-bottom: 4px;
            color: #555;
            font-weight: 600;
            text-transform: uppercase;
        }
        .progress-bg {
            height: 6px;
            background-color: #f0f0f0;
            border-radius: 3px;
            overflow: hidden;
            box-shadow: inset 0 1px 2px rgba(0,0,0,0.05);
        }
        .progress-fill {
            height: 100%;
            background-color: #FFC107; /* Amarelo (aten√ß√£o) inicial */
            width: 0%;
            transition: width 0.3s cubic-bezier(0.25, 0.8, 0.25, 1), background-color 0.3s;
        }
        .progress-fill.concluido {
            background-color: #2E7D32; /* Verde (sucesso) */
        }
        .meta-check {
            color: #ccc;
        }
        .meta-check.ativo {
            color: #2E7D32;
        }

        .resumo-linha-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2px;
        }

        .total-estimado-label {
            font-size: 0.85rem;
            color: #666;
            margin-right: 5px;
        }
        
        #totalValor {
            font-size: 1.1rem;
            color: #666; /* Cor inicial neutra */
        }

        .btn-historico-mini {
            background: #E3F2FD;
            color: #1565C0;
            border: 1px solid #BBDEFB;
            border-radius: 20px;
            padding: 4px 12px;
            font-size: 0.8rem;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .grid-botoes-acao {
            display: grid;
            grid-template-columns: 1fr 1fr; /* 50% para cada */
            gap: 10px;
        }

        .btn-acao {
            padding: 12px;
            border-radius: 8px;
            border: 1px solid #ccc;
            background: white;
            color: #555;
            font-size: 0.9rem;
            font-weight: 700;
            cursor: pointer;
            text-transform: uppercase;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            transition: all 0.2s;
            height: 48px; /* Altura fixa */
        }
        .btn-acao:hover { background-color: #f9f9f9; border-color: #bbb; }
        
        .btn-destaque {
            background-color: var(--cor-whatsapp);
            color: white;
            border: none;
            opacity: 0.6; /* Inicia desabilitado visualmente */
            pointer-events: none;
            /* REMOVIDO: grid-column: span 2; */
        }
        .btn-destaque.ativo {
            opacity: 1;
            pointer-events: auto;
            box-shadow: 0 4px 10px rgba(37, 211, 102, 0.4);
        }
        
        .btn-calc {
            background-color: var(--cor-primaria);
            color: white;
            border: none;
        }

        /* LISTA HISTORICO */
        .historico-lista {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        .historico-item {
            background: #f9f9f9;
            border: 1px solid #eee;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background 0.2s;
        }
        .historico-item:hover {
            background: #E3F2FD;
            border-color: #BBDEFB;
        }
        .hist-data {
            font-weight: 700;
            color: var(--cor-primaria);
            font-size: 0.9rem;
            display: block;
        }
        .hist-resumo {
            font-size: 0.8rem;
            color: #666;
        }
        .hist-valor {
            font-weight: 700;
            color: var(--cor-destaque-vermelho);
        }

        /* OUTRAS SE√á√ïES */
        .card { 
            background: white; 
            border-radius: 12px;
            padding: 15px; 
            margin-bottom: 15px; 
            border: 1px solid #f0f0f0; 
            box-shadow: 0 2px 8px rgba(0,0,0,0.03); 
            height: 100%; 
            display: flex;
            flex-direction: column;
        }
        
        .card h2 { 
            font-size: 1.2rem; 
            font-weight: 600; 
            letter-spacing: -0.3px;
            margin-bottom: 10px;
        }

        .section-icon-header { text-align: center; margin-bottom: 15px; }
        .section-icon-header img {
            width: 50px; height: 50px; object-fit: contain; background-color: var(--cor-primaria);
            border-radius: 50%; padding: 10px; box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }
        .lista-pagamento li { padding: 12px 0; border-bottom: 1px solid #f0f0f0; font-size: 0.95rem; display: flex; align-items: center; color: #555; }
        .emoji-icon { margin-right: 10px; font-size: 1.2rem; }

        /* MODAIS SIMPLES */
        .modal-variacao {
            display: none; position: fixed; z-index: 4000; left: 0; top: 0; width: 100%; height: 100%;
            background-color: rgba(0,0,0,0.65); justify-content: center; align-items: center; backdrop-filter: blur(5px);
            padding: 20px;
        }
        .modal-info-content {
            background-color: white; width: 100%; max-width: 340px; border-radius: 16px; 
            overflow: hidden; box-shadow: 0 10px 30px rgba(0,0,0,0.4);
            display: flex; flex-direction: column; max-height: 80vh; /* Para scroll se lista for longa */
        }
        .modal-info-header {
            background-color: var(--cor-fundo); padding: 15px; display: flex; 
            justify-content: space-between; align-items: center; border-bottom: 1px solid #eee;
        }
        .btn-fechar-modal-info { 
            background-color: #f5f5f5; border: 1px solid #ddd; color: #555; cursor: pointer;
            padding: 5px 10px; border-radius: 15px; font-size: 0.8rem; font-weight: bold;
        }
        .modal-body-scroll {
            padding: 15px;
            overflow-y: auto;
        }

        /* TOAST */
        #toast-container { position: fixed; bottom: 80px; left: 50%; transform: translateX(-50%); z-index: 6000; }
        .toast-message { background-color: #333; color: white; padding: 15px 25px; border-radius: 8px; font-weight: 600; margin-top: 10px; white-space: normal; box-shadow: 0 4px 10px rgba(0,0,0,0.3); text-align: center; max-width: 90%; font-size: 0.9rem; }

        /* FOOTER */
        .footer-map-container {
            width: 100%; height: 250px; border-radius: 12px; overflow: hidden; margin-top: 15px; border: 1px solid #eee;
        }
        .footer-links-seo { margin-top: 15px; font-size: 0.85rem; }
        .footer-links-seo a { color: #666; text-decoration: none; margin: 0 5px; }

        @media (min-width: 481px) {
            .main-content-wrapper, header, .header-background-bar { max-width: 1100px; } 
            .secao-conteudo { padding: 25px 40px; }
            html { font-size: 16px; } 
            
            /* DESKTOP 3 COLUNAS PARA A GRADE DE PRODUTOS */
            .produtos-grid {
                grid-template-columns: repeat(3, 1fr) !important;
                gap: 20px;
            }
        }
        
        @media (min-width: 1024px) {
            .main-content-wrapper, header, .header-background-bar, .header-top { max-width: 1200px; } 
            body { padding-bottom: 20px; } 
            .logo-pequ { display: none !important; }
            .header-top { margin: 0 auto; justify-content: space-between; padding: 5px 20px; }
            .desktop-only { display: flex !important; }
            .desktop-logo-wrapper { position: relative; width: 60px; }
            .big-logo-desktop { width: 120px; height: 120px; border-radius: 50%; box-shadow: 0 4px 15px rgba(0,0,0,0.15); border: 4px solid white; position: absolute; top: -25px; left: 0; z-index: 3000; }
            .desktop-nav { display: flex; gap: 30px; align-items: center; height: 100%; margin-left: 120px; }
            .desktop-nav a { text-decoration: none; color: var(--cor-primaria); font-weight: 700; font-size: 0.95rem; text-transform: uppercase; padding: 5px 0; }
            
            /* DESKTOP LAYOUT NOVO: SEM SIDEBAR */
            .main-content-wrapper { 
                display: block; /* Remove o grid com sidebar */
                padding: 30px 20px; 
                background-color: transparent; 
                box-shadow: none; 
            }
            
            .seo-text-block { 
                margin-top: 40px; 
                background: white; 
                border-radius: 12px; 
                padding: 30px; 
            }
            
            /* Conte√∫do principal ocupa toda largura */
            #pag-cestas { 
                width: 100%;
            }
            
            /* Se√ß√µes Extras (Pagamento/Entrega) v√£o para baixo */
            .secoes-extras-grid { 
                display: grid !important; 
                grid-template-columns: 1fr 1fr; /* Lado a lado */
                gap: 20px; 
                margin-top: 30px;
                width: 100%;
            }
            
            .barra-acoes {
                position: static; 
                margin-top: 20px;
                border-radius: 8px;
                border: 1px solid #ddd;
            }

            /* 4 COLUNAS NO DESKTOP */
            .produtos-grid {
                grid-template-columns: repeat(4, 1fr) !important;
                gap: 20px;
            }
        }
    </style>
</head>
<body>
    
    <div id="toast-container"></div> 
    <div class="header-background-bar"></div>

    <img src="img/logo-super-cesta-basica-dona-antonia-cuiaba-varzea-grande.avif" width="100" height="100" id="logo-principal" onerror="this.src='https://placehold.co/120x120?text=DA'" alt="Logo Dona Ant√¥nia" class="logo-pequ">

    <header>
        <div class="header-top">
            <div class="desktop-only desktop-logo-wrapper">
                <img src="img/logo-super-cesta-basica-dona-antonia-cuiaba-varzea-grande.avif" class="big-logo-desktop" width="120" height="120" alt="Logo Dona Ant√¥nia" onerror="this.src='https://placehold.co/120x120?text=DA'">
            </div>

            <nav class="desktop-nav desktop-only">
                <a href="#pag-cestas">In√≠cio</a>
                <a href="#pag-pagamento">Pagamento</a>
                <a href="#pag-entrega">Entrega</a>
            </nav>

            <button class="btn-contato-principal" onclick="abrirModalContatos()" aria-label="Abrir op√ß√µes de contato">
                <div class="linha-destaque-top">
                    <i class="fab fa-whatsapp"></i> <span class="desktop-only" style="display: inline !important;">&nbsp;FALE CONOSCO</span><span style="display: inline;" class="mobile-text">SALVAR CONTATO</span>
                </div>
            </button>
        </div>
    </header>

    <main class="main-content-wrapper">
        <div id="pag-cestas">
            <div class="seo-main-title">
                <h1>Monte sua Cesta Personalizada</h1>
                <p>Escolha os produtos e a quantidade que sua fam√≠lia precisa.</p>
            </div>

            <div class="secao-conteudo">
                <div class="monte-sua-cesta-container">
                    <div class="instrucoes-cesta">
                        <strong><i class="fas fa-exclamation-circle"></i> Regras para Encomendar:</strong>
                        <ul>
                            <li>M√≠nimo de <strong>10 produtos diferentes</strong>.</li>
                            <li>M√≠nimo de <strong>20 itens no total</strong> da cesta.</li>
                            <li>Clique em <strong>CALCULAR</strong> para ver o valor.</li>
                        </ul>
                    </div>

                    <!-- GRADE DE PRODUTOS INJETADA VIA JS -->
                    <div id="gridProdutos" class="produtos-grid">
                        <!-- Itens ser√£o carregados aqui -->
                    </div>
                </div>

                <!-- BARRA DE A√á√ïES COMPACTA -->
                <div class="barra-acoes">
                    
                    <!-- GAMIFICA√á√ÉO: PROGRESSO -->
                    <div class="gamificacao-container">
                        <div class="meta-item">
                            <div class="meta-texto">
                                <span class="meta-label">Prod. Diferentes <i id="icon-dif" class="fas fa-check-circle meta-check"></i></span>
                                <span id="label-dif" class="meta-valor">0/10</span>
                            </div>
                            <div class="progress-bg">
                                <div id="bar-dif" class="progress-fill" style="width: 0%"></div>
                            </div>
                        </div>
                        <div class="meta-item">
                            <div class="meta-texto">
                                <span class="meta-label">Total Itens <i id="icon-total" class="fas fa-check-circle meta-check"></i></span>
                                <span id="label-total" class="meta-valor">0/20</span>
                            </div>
                            <div class="progress-bg">
                                <div id="bar-total" class="progress-fill" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>

                    <div class="resumo-linha-top">
                        <div style="display:flex; align-items: baseline;">
                            <span class="total-estimado-label">Total Estimado:</span>
                            <span id="totalValor">Clique Calcular</span>
                        </div>
                        <button class="btn-historico-mini" onclick="abrirHistorico()">
                            <i class="fas fa-history"></i> Pedidos
                        </button>
                    </div>
                    
                    <div class="grid-botoes-acao">
                        <button class="btn-acao btn-calc" onclick="calcularTotal()">
                            <i class="fas fa-calculator"></i> Calcular
                        </button>
                        <!-- Bot√£o Encomendar inicia "desativado" -->
                        <button id="btnEncomendar" class="btn-acao btn-destaque" onclick="encomendarCesta()">
                            <i class="fab fa-whatsapp"></i> Encomendar
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="secoes-extras-grid">
            <div id="pag-pagamento" class="secao-conteudo">
                <div class="card">
                    <div class="section-icon-header">
                        <img src="img/pagamento.png" width="60" height="60" alt="Pagamento" onerror="this.src='https://placehold.co/60x60/2196F3/ffffff?text=P'">
                    </div>
                    <h2 style="text-align: center;">Formas de Pagamento</h2>
                    <ul class="lista-pagamento">
                        <li><span class="emoji-icon">üíµ</span> Dinheiro</li>
                        <li><span class="emoji-icon">‚ú®</span> Pix</li>
                        <li><span class="emoji-icon">üí≥</span> Cart√£o de D√©bito e Cr√©dito</li>
                        <li><span class="emoji-icon">ü•ó</span> Alimenta√ß√£o: Alelo, Sodexo, Pluxee</li>
                    </ul>
                </div>
            </div>

            <div id="pag-entrega" class="secao-conteudo">
                <div class="card">
                    <div class="section-icon-header">
                        <img src="img/entrega.png" width="60" height="60" alt="Entrega" onerror="this.src='https://placehold.co/60x60/FF9800/ffffff?text=E'">
                    </div>
                    <h2 style="text-align: center; color: var(--cor-entrega);">Entrega Gr√°tis</h2>
                    <p style="text-align: center; color: #555;">Em toda Cuiab√° e V√°rzea Grande.</p>
                </div>
            </div>
        </div>

        <footer class="seo-text-block" style="text-align: center; font-size: 0.85rem; color: #888; padding: 20px;">
            <p><strong>Dona Ant√¥nia - Cestas Personalizadas</strong></p>
            <p>Cuiab√° - MT &bull; V√°rzea Grande - MT</p>
            <div class="footer-map-container" style="margin-top: 20px;">
                <iframe src="https://maps.google.com/maps?q=9W4X%2BGX%20Jardim%20Nossa%20Sra.%20Aparecida%2C%20Cuiab√°%20-%20MT&t=&z=13&ie=UTF8&iwloc=&output=embed" width="100%" height="100%" style="border:0;" allowfullscreen="" loading="lazy"></iframe>
            </div>
        </footer>
    </main>

    <!-- MODAL CONTATOS -->
    <div id="modalContatos" class="modal-variacao" onclick="if(event.target === this) fecharModalContatos()">
        <div class="modal-info-content" style="max-width: 340px;">
            <div class="modal-info-header">
                <h3>Fale Conosco</h3>
                <button class="btn-fechar-modal-info" onclick="fecharModalContatos()">Fechar</button>
            </div>
            <div style="padding: 20px; text-align: center;">
                <a href="https://wa.me/5565996813588" class="btn-acao btn-destaque" target="_blank" style="margin-bottom: 15px; opacity: 1; pointer-events: auto;">
                    <i class="fab fa-whatsapp"></i> Chamar no WhatsApp
                </a>
                <p>Ou ligue: (65) 99681-3588</p>
            </div>
        </div>
    </div>

    <!-- MODAL HIST√ìRICO (NOVO) -->
    <div id="modalHistorico" class="modal-variacao" onclick="if(event.target === this) fecharModalHistorico()">
        <div class="modal-info-content">
            <div class="modal-info-header">
                <h3>√öltimos Pedidos</h3>
                <button class="btn-fechar-modal-info" onclick="fecharModalHistorico()">Fechar</button>
            </div>
            <div class="modal-body-scroll">
                <p style="font-size: 0.85rem; color: #666; margin-bottom: 15px;">Clique em um pedido para recarregar a cesta e encomendar novamente.</p>
                <ul id="listaHistorico" class="historico-lista">
                    <!-- Itens via JS -->
                </ul>
            </div>
        </div>
    </div>

    <script>
        // === LISTA DE PRODUTOS ===
        const produtos = [
            // ALIMENTOS
            { id: 1, categoria: "alimentos", nome: "Arroz 5kg", preco: 25.00, img: "img/arroz.png" },
            { id: 2, categoria: "alimentos", nome: "A√ß√∫car Cristal 2kg", preco: 9.50, img: "img/acucar.png" },
            { id: 3, categoria: "alimentos", nome: "√ìleo de Soja 900ml", preco: 6.00, img: "img/oleo.png" },
            { id: 4, categoria: "alimentos", nome: "Feij√£o Da Casa 1kg", preco: 8.50, img: "img/feijao.png" },
            { id: 5, categoria: "alimentos", nome: "Caf√© Caboclo 500g", preco: 18.00, img: "img/cafe.png" },
            { id: 6, categoria: "alimentos", nome: "Espaguete 500g", preco: 4.50, img: "img/macarrao.png" },
            { id: 7, categoria: "alimentos", nome: "Ovos (Cartela 12)", preco: 12.00, img: "img/ovos.png" },
            { id: 8, categoria: "alimentos", nome: "Mistura p/ Bolo 400g", preco: 5.00, img: "img/bolo.png" },
            { id: 9, categoria: "alimentos", nome: "Trigo 1kg", preco: 5.50, img: "img/trigo.png" },
            { id: 10, categoria: "alimentos", nome: "Sal 1kg", preco: 2.00, img: "img/sal.png" },
            { id: 11, categoria: "alimentos", nome: "Molho Tomate FUGINI 340g", preco: 3.00, img: "img/molho.png" },
            { id: 12, categoria: "alimentos", nome: "Milho Lata/Sach√™ 250g", preco: 3.50, img: "img/milho.png" },
            { id: 13, categoria: "alimentos", nome: "Tempero Pronto 300g", preco: 4.00, img: "img/tempero.png" },
            { id: 14, categoria: "alimentos", nome: "Bolacha Recheada My Bit", preco: 3.50, img: "img/bolacha.png" },
            { id: 15, categoria: "alimentos", nome: "Miojo Apti", preco: 2.00, img: "img/miojo.png" },
            { id: 16, categoria: "alimentos", nome: "Suco em P√≥", preco: 1.50, img: "img/suco.png" },
            
            // LIMPEZA E HIGIENE
            { id: 17, categoria: "limpeza", nome: "Sab√£o Barra YPE (5 un)", preco: 11.00, img: "img/sabao_barra.png" },
            { id: 18, categoria: "limpeza", nome: "Creme Dental Sorriso 70g", preco: 4.50, img: "img/creme.png" },
            { id: 19, categoria: "limpeza", nome: "Papel Higi√™nico (4un)", preco: 6.00, img: "img/papel.png" },
            { id: 20, categoria: "limpeza", nome: "Amaciante Ype 2 Litros", preco: 15.00, img: "img/amaciante.png" },
            { id: 21, categoria: "limpeza", nome: "Desinfetante Remmus 2L", preco: 8.00, img: "img/desinfetante.png" },
            { id: 22, categoria: "limpeza", nome: "Sab√£o P√≥ OMO 800g", preco: 13.00, img: "img/sabao_po.png" },
            { id: 23, categoria: "limpeza", nome: "Detergente Ype 500ml", preco: 2.50, img: "img/detergente.png" },
            { id: 24, categoria: "limpeza", nome: "Qboa 1 Litro", preco: 5.00, img: "img/qboa.png" },
            { id: 25, categoria: "limpeza", nome: "Sabonete Palmolive 90g", preco: 2.80, img: "img/sabonete.png" },
            { id: 26, categoria: "limpeza", nome: "Esponja A√ßo Assolan", preco: 2.20, img: "img/aco.png" },
            { id: 27, categoria: "limpeza", nome: "Esponja Lavar Lou√ßa", preco: 1.50, img: "img/bucha.png" }
        ];

        // Estado das quantidades e Hist√≥rico
        let cesta = {}; 
        let historicoPedidos = [];

        // Inicializa√ß√£o
        document.addEventListener('DOMContentLoaded', () => {
            renderizarProdutos();
            carregarCestaSalva(); // Carrega cesta atual (se houver)
            carregarHistoricoStorage(); // Carrega lista de pedidos antigos
        });

        function renderizarProdutos() {
            const grid = document.getElementById('gridProdutos');
            grid.innerHTML = '';

            // Renderizar ALIMENTOS
            adicionarCabecalho(grid, 'Alimentos');
            produtos.filter(p => p.categoria === 'alimentos').forEach(prod => criarCard(prod, grid));

            // Renderizar LIMPEZA
            adicionarCabecalho(grid, 'Limpeza e Higiene');
            produtos.filter(p => p.categoria === 'limpeza').forEach(prod => criarCard(prod, grid));
        }

        function adicionarCabecalho(container, texto) {
            const div = document.createElement('div');
            div.className = 'categoria-titulo';
            div.innerText = texto;
            container.appendChild(div);
        }

        function criarCard(prod, container) {
            const qtd = cesta[prod.id] || 0;
            const card = document.createElement('div');
            card.className = 'produto-item';
            // Se j√° tiver item na cesta ao criar, marca como selecionado
            if (qtd > 0) card.classList.add('selecionado');
            card.id = `card-produto-${prod.id}`; // Add ID para f√°cil acesso
            
            card.innerHTML = `
                <div class="prod-img-wrapper">
                    <img src="${prod.img}" alt="${prod.nome}" onerror="this.src='https://placehold.co/150x150/eee/999?text=Item'">
                </div>
                <div class="prod-info">
                    <div class="prod-nome">${prod.nome}</div>
                    <div class="controle-qtd">
                        <button class="btn-qtd" onclick="alterarQtd(${prod.id}, -1)">-</button>
                        <span class="qtd-display" id="qtd-${prod.id}">${qtd}</span>
                        <button class="btn-qtd" onclick="alterarQtd(${prod.id}, 1)">+</button>
                    </div>
                </div>
            `;
            container.appendChild(card);
        }

        function alterarQtd(id, delta) {
            if (!cesta[id]) cesta[id] = 0;
            cesta[id] += delta;
            
            if (cesta[id] < 0) cesta[id] = 0;
            
            // Atualiza visual apenas do n√∫mero
            document.getElementById(`qtd-${id}`).innerText = cesta[id];
            
            // Atualiza visual do card (verde se > 0)
            const card = document.getElementById(`card-produto-${id}`);
            if (cesta[id] > 0) {
                card.classList.add('selecionado');
            } else {
                card.classList.remove('selecionado');
            }

            // RESETAR O CALCULO VISUAL
            document.getElementById('totalValor').innerText = "Clique em Calcular";
            document.getElementById('totalValor').style.color = "#666";
            document.getElementById('totalValor').style.fontWeight = "normal";
            
            const btnEncomendar = document.getElementById('btnEncomendar');
            btnEncomendar.classList.remove('ativo');
            
            // ATUALIZA GAMIFICA√á√ÉO EM TEMPO REAL
            atualizarBarrasProgresso();

            // Salva estado atual (auto-save discreto)
            localStorage.setItem('minhaCestaPersonalizada', JSON.stringify(cesta));
        }

        function atualizarBarrasProgresso() {
            let itensCount = 0;
            let produtosDiferentesCount = 0;
            
            produtos.forEach(prod => {
                const qtd = cesta[prod.id] || 0;
                if (qtd > 0) {
                    itensCount += qtd;
                    produtosDiferentesCount++;
                }
            });

            // Metas
            const metaDif = 10;
            const metaTotal = 20;

            // Calcula porcentagens (max 100%)
            const pctDif = Math.min((produtosDiferentesCount / metaDif) * 100, 100);
            const pctTotal = Math.min((itensCount / metaTotal) * 100, 100);

            // Atualiza Labels
            document.getElementById('label-dif').innerText = `${produtosDiferentesCount}/${metaDif}`;
            document.getElementById('label-total').innerText = `${itensCount}/${metaTotal}`;

            // Atualiza Barras
            const barDif = document.getElementById('bar-dif');
            const barTotal = document.getElementById('bar-total');
            const iconDif = document.getElementById('icon-dif');
            const iconTotal = document.getElementById('icon-total');

            barDif.style.width = `${pctDif}%`;
            barTotal.style.width = `${pctTotal}%`;

            // Verifica Conclus√£o (Diferentes)
            if (produtosDiferentesCount >= metaDif) {
                barDif.classList.add('concluido');
                iconDif.classList.add('ativo');
            } else {
                barDif.classList.remove('concluido');
                iconDif.classList.remove('ativo');
            }

            // Verifica Conclus√£o (Total)
            if (itensCount >= metaTotal) {
                barTotal.classList.add('concluido');
                iconTotal.classList.add('ativo');
            } else {
                barTotal.classList.remove('concluido');
                iconTotal.classList.remove('ativo');
            }
        }

        function calcularTotal() {
            let total = 0;
            let itensCount = 0;
            let produtosDiferentesCount = 0;
            
            produtos.forEach(prod => {
                const qtd = cesta[prod.id] || 0;
                if (qtd > 0) {
                    total += qtd * prod.preco;
                    itensCount += qtd;
                    produtosDiferentesCount++;
                }
            });

            // VALIDA√á√ÉO
            const minProdutosDif = 10;
            const minItensTotal = 20;

            if (produtosDiferentesCount < minProdutosDif || itensCount < minItensTotal) {
                let msgErro = "Para calcular, falta:\n";
                if (produtosDiferentesCount < minProdutosDif) msgErro += `üî¥ +${minProdutosDif - produtosDiferentesCount} produtos diferentes\n`;
                if (itensCount < minItensTotal) msgErro += `üî¥ +${minItensTotal - itensCount} itens no total`;

                mostrarToast(msgErro);
                
                document.getElementById('totalValor').innerText = "Incompleto";
                document.getElementById('totalValor').style.color = "red";
                
                const btnEncomendar = document.getElementById('btnEncomendar');
                btnEncomendar.classList.remove('ativo');
                
                return false; 
            }

            // SUCESSO
            const valorFormatado = `R$ ${total.toFixed(2).replace('.', ',')}`;
            const labelTotal = document.getElementById('totalValor');
            labelTotal.innerText = valorFormatado;
            labelTotal.style.color = "var(--cor-destaque-vermelho)";
            labelTotal.style.fontWeight = "800";
            
            const btnEncomendar = document.getElementById('btnEncomendar');
            btnEncomendar.classList.add('ativo');
            
            return { total, valorFormatado, itensCount }; 
        }

        function encomendarCesta() {
            const resultado = calcularTotal();
            if (!resultado) return;

            // SALVAR NO HIST√ìRICO ANTES DE ENVIAR
            salvarPedidoHistorico(resultado.total, resultado.itensCount);

            let total = 0;
            let mensagem = "*Ol√°! Montei minha Cesta Personalizada no site:*\n\n";
            let itensAlimentos = "";
            let itensLimpeza = "";

            produtos.forEach(prod => {
                const qtd = cesta[prod.id] || 0;
                if (qtd > 0) {
                    total += qtd * prod.preco;
                    if(prod.categoria === 'alimentos') {
                        itensAlimentos += `‚ñ™ ${qtd}x ${prod.nome}\n`;
                    } else {
                        itensLimpeza += `‚ñ™ ${qtd}x ${prod.nome}\n`;
                    }
                }
            });

            if(itensAlimentos) mensagem += "*[ ALIMENTOS ]*\n" + itensAlimentos + "\n";
            if(itensLimpeza) mensagem += "*[ LIMPEZA E HIGIENE ]*\n" + itensLimpeza;

            mensagem += `\n*Total Estimado: R$ ${total.toFixed(2).replace('.', ',')}*`;
            mensagem += `\n\n_Aguardo a confirma√ß√£o do pedido e entrega._`;

            const url = `https://wa.me/5565996813588?text=${encodeURIComponent(mensagem)}`;
            window.open(url, '_blank');
        }

        // === L√ìGICA DE HIST√ìRICO ===

        function carregarHistoricoStorage() {
            const hist = localStorage.getItem('donaAntoniaHistorico');
            if (hist) {
                historicoPedidos = JSON.parse(hist);
            }
        }

        function salvarPedidoHistorico(total, itens) {
            const novoPedido = {
                data: new Date().toLocaleString('pt-BR'),
                total: total,
                itensQtd: itens,
                cestaSalva: { ...cesta } // Copia o objeto cesta atual
            };
            
            // Adiciona no in√≠cio e mant√©m apenas os √∫ltimos 10
            historicoPedidos.unshift(novoPedido);
            if (historicoPedidos.length > 10) historicoPedidos.pop();
            
            localStorage.setItem('donaAntoniaHistorico', JSON.stringify(historicoPedidos));
        }

        function abrirHistorico() {
            const lista = document.getElementById('listaHistorico');
            lista.innerHTML = '';

            if (historicoPedidos.length === 0) {
                lista.innerHTML = '<li style="text-align:center; color:#999; padding:20px;">Nenhum pedido recente encontrado.</li>';
            } else {
                historicoPedidos.forEach((pedido, index) => {
                    const li = document.createElement('li');
                    li.className = 'historico-item';
                    li.onclick = () => carregarPedidoDoHistorico(index);
                    
                    li.innerHTML = `
                        <div>
                            <span class="hist-data">${pedido.data}</span>
                            <span class="hist-resumo">${pedido.itensQtd} itens</span>
                        </div>
                        <span class="hist-valor">R$ ${pedido.total.toFixed(2).replace('.', ',')}</span>
                    `;
                    lista.appendChild(li);
                });
            }

            document.getElementById('modalHistorico').style.display = 'flex';
        }

        function carregarPedidoDoHistorico(index) {
            const pedido = historicoPedidos[index];
            if (!pedido) return;

            // Restaura a cesta
            cesta = { ...pedido.cestaSalva };
            localStorage.setItem('minhaCestaPersonalizada', JSON.stringify(cesta));
            
            // Atualiza UI
            produtos.forEach(prod => {
                const qtd = cesta[prod.id] || 0;
                
                const el = document.getElementById(`qtd-${prod.id}`);
                if(el) el.innerText = qtd;

                // Atualiza visual do card
                const card = document.getElementById(`card-produto-${prod.id}`);
                if (card) {
                    if (qtd > 0) card.classList.add('selecionado');
                    else card.classList.remove('selecionado');
                }
            });

            // Atualiza Barras
            atualizarBarrasProgresso();

            // Tenta calcular e validar
            calcularTotal();
            
            fecharModalHistorico();
            mostrarToast("Pedido recarregado com sucesso!");
        }

        function fecharModalHistorico() {
            document.getElementById('modalHistorico').style.display = 'none';
        }

        // === HELPERS DE PERSIST√äNCIA B√ÅSICA ===
        function carregarCestaSalva() {
            const salva = localStorage.getItem('minhaCestaPersonalizada');
            if (salva) {
                cesta = JSON.parse(salva);
                produtos.forEach(prod => {
                    const qtd = cesta[prod.id] || 0;
                    
                    const el = document.getElementById(`qtd-${prod.id}`);
                    if(el) el.innerText = qtd;

                    // Atualiza visual do card ao carregar
                    const card = document.getElementById(`card-produto-${prod.id}`);
                    if (card) {
                        if (qtd > 0) card.classList.add('selecionado');
                        else card.classList.remove('selecionado');
                    }
                });
                // Chama para setar o estado inicial das barras
                atualizarBarrasProgresso();
            }
        }

        function mostrarToast(msg) {
            const container = document.getElementById('toast-container');
            const toast = document.createElement('div');
            toast.className = 'toast-message';
            toast.innerText = msg;
            container.appendChild(toast);
            setTimeout(() => {
                toast.remove();
            }, 4000);
        }

        function abrirModalContatos() { document.getElementById('modalContatos').style.display = 'flex'; }
        function fecharModalContatos() { document.getElementById('modalContatos').style.display = 'none'; }
    </script>
</body>
</html>

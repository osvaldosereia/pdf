<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Cesta B√°sica em Cuiab√° e V√°rzea Grande | Dona Ant√¥nia</title>
    
    <!-- Link para √≠cones (Font Awesome) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- NOVO: Link do Manifest PWA -->
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="uploaded:icon-512.jpg-e6b1d93e-bd40-4cbe-8eb9-1ce2d7412765">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">

    <style>
        /* ==================================================================== */
        /* === ESTILOS GLOBAIS E ESTRUTURA (ADAPTADOS DO ARQUIVO ANEXO) ==== */
        /* ==================================================================== */
        * { box-sizing: border-box; }

        :root {
            --cor-primaria: #D32F2F; /* Vermelho Principal */
            --cor-whatsapp: #25D366;
            --cor-texto: #222;
            --cor-fundo: #fafafa;
            --cor-pagamento: #2196F3; /* Azul */
            --cor-sorteio: #4CAF50; /* Verde */
            --cor-header-fundo: #f5f5f5;
            --cor-pwa: #4CAF50; /* Verde para o Banner PWA */
        }

        html { background-color: #e0e0e0; scroll-behavior: smooth; }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #e0e0e0; 
            color: var(--cor-texto);
            margin: 0; 
            padding: 0;
            /* Padding para acomodar o cabe√ßalho fixo */
            padding-top: 100px; 
            padding-bottom: 20px;
            min-height: 10vh;
            position: relative; 
            width: 100%;
        }

        .main-content-wrapper {
            max-width: 480px; /* Padr√£o mobile */
            margin: 0 auto; 
            background-color: var(--cor-fundo); 
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }

        /* --- CABE√áALHO FIXO --- */
        header {
            background-color: white;
            height: 70px; 
            padding: 0;
            display: flex;
            flex-direction: column;
            box-shadow: 0 4px 10px rgba(0,0,0,0.08);
            position: fixed;
            top: 0;
            left: 50%; 
            transform: translateX(-50%); 
            width: 100%;
            max-width: 480px; 
            z-index: 1000;
        }

        .header-background-bar {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 65px; 
            background-color: var(--cor-header-fundo);
            z-index: 999;
        }
        
        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            height: 70px; 
            padding: 5px 15px;
        }
        
        .header-left, .header-icons { 
            display: flex; 
            align-items: center; 
            flex: 1; 
            z-index: 1001; 
        }

        .header-left { justify-content: flex-start; }
        .header-icons { justify-content: flex-end; gap: 8px; }
        
        /* Logo (FIXA e CENTRALIZADA) - Fundo Branco Adicionado */
        .logo-pequena { 
            height: 120px; 
            width: 120px; 
            object-fit: cover; 
            border-radius: 50%; 
            box-shadow: 0 4px 15px rgba(0,0,0,0.4); 
            position: fixed;
            top: 8px; 
            z-index: 2000; 
            left: 50%; 
            transform: translateX(-50%);
            background-color: white; /* NOVO: Fundo branco */
            padding: 2px; /* Pequeno padding para garantir que o fundo branco envolva a imagem */
        }

        .header-btn {
            padding: 6px 10px; 
            border-radius: 6px;
            font-size: 13px; 
            font-weight: bold;
            text-decoration: none;
            display: inline-flex; 
            align-items: center;
            justify-content: center;
            transition: background-color 0.2s, transform 0.2s;
            white-space: nowrap; 
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            color: white; 
        }
        .header-btn:active { transform: scale(0.95); }
        .btn-whatsapp-save { background-color: var(--cor-whatsapp); }
        .btn-insta-follow { background: linear-gradient(45deg, #f09433, #dc2743, #bc1888); }
        
        /* --- ESTILOS DO NOVO BANNER DE INSTALA√á√ÉO PWA --- */
        #pwa-install-banner {
            display: none; /* Escondido por padr√£o, s√≥ √© exibido pelo JS */
            background-color: var(--cor-pwa);
            color: white;
            text-align: center;
            padding: 10px 15px;
            position: fixed;
            top: 70px; /* Abaixo do header */
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
            max-width: 480px;
            z-index: 900;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: top 0.3s ease-out; /* Transi√ß√£o para dar um efeito de slide */
        }

        #pwa-install-banner:hover {
            background-color: #388E3C; /* Tom mais escuro */
        }

        #pwa-install-banner span {
            margin-right: 10px;
        }
        
        /* Ajuste do padding do body quando o banner PWA estiver vis√≠vel */
        body.pwa-active {
            padding-top: 145px; /* 70px (header) + 5px (margem) + 45px (banner PWA) + 25px (logo top padding) */
        }
        
        /* --- CARDS E SE√á√ïES --- */
        .secao-conteudo { padding: 15px; }
        .card { 
            background: white; 
            border-radius: 12px; 
            padding: 15px; 
            margin-bottom: 15px; 
            border: 1px solid #f0f0f0; 
            box-shadow: 0 2px 5px rgba(0,0,0,0.02); 
        }
        
        h2 { color: var(--cor-primaria); margin-top: 0; font-size: 1.2rem; }
        
        /* Estilos para o Card de Produto (Cesta) */
        .card-cesta { padding: 0; overflow: hidden; border: 1px solid #eee; }
        .cesta-header { background-color: var(--cor-primaria); padding: 15px; text-align: center; color: white; }
        .cesta-header h3 { margin: 0; color: white; font-size: 20px; text-transform: uppercase; letter-spacing: 1px; }
        .cesta-body { padding: 15px; }

        /* Galeria de Fotos Quadradas */
        .galeria-fotos { 
            position: relative; 
            margin-bottom: 15px; 
            border-radius: 12px; 
            overflow: hidden; 
            width: 100%; 
            aspect-ratio: 1 / 1; /* Formato Quadrado */
            background: #eee;
        }
        .img-wrapper {
            position: absolute; 
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        .img-wrapper.active { opacity: 1; position: relative; }
        .img-wrapper img { width: 100%; height: 100%; object-fit: cover; display: block; }
        
        /* Indicador de Swipe/Bot√£o de Foto */
        .swipe-indicator {
            position: absolute;
            bottom: 15px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 60; 
            color: white; 
            background: rgba(0, 0, 0, 0.7);
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer; 
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
            transition: opacity 0.3s ease, background 0.2s;
        }

        /* Lista de Pre√ßos */
        .lista-precos-cesta {
            background-color: #f9f9f9; border-radius: 8px; padding: 12px;
            margin: 15px 0; border: 1px solid #eee;
        }
        .item-preco { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; font-size: 15px; color: #444; }
        .item-preco:last-child { margin-bottom: 0; }
        .item-preco strong { color: var(--cor-primaria); font-size: 18px; }

        /* Bot√£o Encomendar √önico */
        .botoes-wrapper { display: flex; gap: 10px; margin-top: 15px; }
        .btn {
            display: flex; align-items: center; justify-content: center;
            width: 100%; padding: 15px; border: none; border-radius: 8px;
            font-size: 16px; font-weight: bold; cursor: pointer;
            text-decoration: none; color: white; text-align: center;
            background-color: var(--cor-whatsapp); /* Usando WhatsApp green para destaque */
            box-shadow: 0 4px 10px rgba(37, 211, 102, 0.4);
            transition: transform 0.2s;
        }
        .btn:active { transform: scale(0.98); }
        
        /* --- ESTILOS PAGAMENTO E SORTEIO --- */
        .section-icon-header { text-align: center; margin-bottom: 20px; position: relative; z-index: 10; }
        .section-icon-header img {
            width: 60px; 
            height: 60px;
            object-fit: contain;
            background-color: var(--cor-primaria);
            border-radius: 50%;
            padding: 10px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }

        .lista-pagamento { list-style: none; padding: 0; }
        .lista-pagamento li { 
            padding: 10px 0; 
            border-bottom: 1px solid #eee; 
            font-size: 16px; 
            display: flex; 
            align-items: center; 
        }
        .lista-pagamento li span.emoji-icon {
            font-size: 20px; 
            width: 30px;
            text-align: center;
            line-height: 1;
            margin-right: 5px;
        }

        .area-resultado-busca {
            background-color: #e8f5e9; 
            border: 1px solid #a5d6a7;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            text-align: center;
            animation: fadeIn 0.3s ease;
        }
        .area-resultado-busca h2 { color: #388e3c; } 
        #cadastro-novo {
            background-color: #fff3e0; 
            border: 1px solid #ffcc80;
        }
        #cadastro-novo h2 { color: #e65100; } 
        input, select { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 8px; margin-bottom: 10px; font-size: 16px; }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* --- ESTILOS DO MODAL VARIA√á√ÉO (MANTIDO) --- */
        .modal-variacao {
            display: none;
            position: fixed;
            z-index: 4000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.6);
            justify-content: center;
            align-items: center;
        }

        /* --- NOVO ESTILO DO MODAL RECEPTIVO (POPUP) --- */
        #modalReceptivo {
            display: none; /* Escondido por padr√£o, s√≥ o JS exibe */
            position: fixed;
            z-index: 5000; /* Prioridade m√°xima */
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.7);
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(2px);
        }
        .modal-receptivo-content {
            background-color: white;
            width: 90%;
            max-width: 380px;
            border-radius: 16px;
            padding: 25px;
            text-align: center;
            box-shadow: 0 8px 30px rgba(0,0,0,0.4);
            animation: zoomIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); /* Efeito de molas */
        }
        @keyframes zoomIn {
            from { transform: scale(0.7); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        .titulo-receptivo {
            color: var(--cor-primaria);
            font-size: 1.5rem;
            margin-bottom: 10px;
            font-weight: 900;
        }
        .subtitulo-receptivo {
            color: #555;
            font-size: 1.1rem;
            margin-bottom: 25px;
            font-weight: 500;
            line-height: 1.4;
        }
        .btn-receptivo {
            padding: 15px 25px;
            border-radius: 10px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s, background-color 0.2s;
            display: block;
            width: 100%;
            border: none;
        }
        .btn-receptivo:active { transform: scale(0.98); }
        .btn-ver-cestas {
            background-color: var(--cor-primaria);
            color: white;
            box-shadow: 0 4px 10px rgba(211, 47, 47, 0.4);
        }
        .btn-eu-quero {
            background-color: var(--cor-whatsapp);
            color: white;
            box-shadow: 0 4px 10px rgba(37, 211, 102, 0.4);
        }
        .etapa-modal { display: none; }
        .etapa-modal.ativa { display: block; }
        
        /* O resto dos estilos de modal-variacao-content, btn-fechar-modal-var, etc. s√£o mantidos */
        .modal-variacao-content {
            background-color: white;
            width: 90%;
            max-width: 350px;
            border-radius: 16px;
            padding: 20px;
            position: relative;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
            animation: zoomIn 0.2s ease-out;
            text-align: center;
        }
        .btn-fechar-modal-var { position: absolute; top: 10px; right: 15px; background: none; border: none; font-size: 24px; color: #999; cursor: pointer; }
        .opcao-select {
            display: flex; align-items: center; justify-content: space-between; padding: 15px; border: 2px solid #eee; border-radius: 8px; margin-bottom: 10px; cursor: pointer; transition: all 0.2s; text-align: left;
        }
        .opcao-select:active { transform: scale(0.98); }
        .opcao-select.selected { border-color: var(--cor-primaria); background-color: #ffebee; }
        .opcao-nome { font-weight: bold; color: #333; }
        .opcao-preco { color: var(--cor-primaria); font-weight: 900; }
        .radio-custom { width: 20px; height: 20px; border: 2px solid #ccc; border-radius: 50%; position: relative; }
        .selected .radio-custom { border-color: var(--cor-primaria); }
        .selected .radio-custom::after { content: ''; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 10px; height: 10px; background-color: var(--cor-primaria); border-radius: 50%; }
        .btn-confirmar-pedido { width: 100%; padding: 15px; background-color: var(--cor-whatsapp); color: white; border: none; border-radius: 8px; font-weight: bold; font-size: 16px; margin-top: 10px; cursor: pointer; text-transform: uppercase; display: flex; align-items: center; justify-content: center; gap: 10px; }
        .btn-confirmar-pedido:disabled { background-color: #ccc; cursor: not-allowed; }


        /* --- RESPONSIVIDADE DESKTOP (AJUSTADA PARA 700PX) --- */
        @media (min-width: 481px) {
            .main-content-wrapper {
                max-width: 700px; /* Reduzido para ser mais parecido com o mobile */
                box-shadow: 0 0 25px rgba(0,0,0,0.15); 
            }
            header {
                max-width: 700px; /* Header acompanha o novo limite */
            }
            .header-background-bar {
                max-width: 700px; /* Barra de fundo acompanha o novo limite */
                left: 50%;
                transform: translateX(-50%);
            }
            #pwa-install-banner {
                max-width: 700px;
            }
            .secao-conteudo {
                padding: 20px 30px; 
            }
        }
        
        /* Layout de 2 colunas para Produtos (tablet/desktop) */
        @media (min-width: 768px) {
            /* Banner de 8 anos ocupa toda a largura */
            #pag-cestas .card:first-child {
                grid-column: 1 / -1; 
            }
            
            .cesta-cards-grid {
                display: grid;
                grid-template-columns: 1fr 1fr; /* Duas colunas iguais */
                gap: 20px; 
            }
            .card-cesta {
                width: 100%;
                margin-bottom: 0 !important; 
            }
            /* Cards de Pagamento/Sorteio podem ficar lado a lado no desktop */
            .secoes-extras-grid {
                display: grid;
                grid-template-columns: 1fr 1fr; 
                gap: 20px;
                padding: 0 30px; 
            }
            /* Remove o padding interno da se√ß√£o se o grid for usado */
            #pag-pagamento, #pag-sorteio {
                padding: 20px 0;
            }
            #pag-pagamento .section-icon-header, #pag-sorteio .section-icon-header {
                 /* Centraliza o √≠cone separador entre as se√ß√µes extras */
                grid-column: 1 / -1;
            }
        }
    </style>
</head>
<body>
    
    <!-- BARRA DE FUNDO CINZA CLARA -->
    <div class="header-background-bar"></div>

    <!-- LOGO FIXA: Usa a imagem enviada (icon-512.jpg) -->
    <img src="uploaded:icon-512.jpg-e6b1d93e-bd40-4cbe-8eb9-1ce2d7412765" 
         onerror="this.src='img/logo1.png'" 
         alt="Logo Dona Ant√¥nia" 
         class="logo-pequena">

    <!-- CABE√áALHO FIXO (Mantido do anexo) -->
    <header>
        <div class="header-top">
            <!-- WHATSAPP NA ESQUERDA -->
            <div class="header-left">
                 <a href="https://wa.me/5565998150975" class="header-btn btn-whatsapp-save" target="_blank" aria-label="Fazer Pedido por WhatsApp">
                    <i class="fab fa-whatsapp" style="margin-right: 5px;"></i> WhatsApp
                </a>
            </div>
            
            <!-- INSTAGRAM NA DIREITA -->
            <div class="header-icons">
                <a href="https://instagram.com/super.cestas.dona.antonia/" class="header-btn btn-insta-follow" target="_blank" aria-label="Seguir no Instagram">
                    <i class="fab fa-instagram" style="margin-right: 5px;"></i> Instagram
                </a>
            </div>
        </div>
    </header>

    <!-- NOVO: BANNER DE INSTALA√á√ÉO DO PWA (ESCONDIDO POR PADR√ÉO) -->
    <!-- Este banner ser√° mostrado pelo JavaScript (beforeinstallprompt) -->
    <div id="pwa-install-banner" onclick="instalarPWA()" role="button" aria-label="Instalar como Aplicativo">
        <i class="fas fa-mobile-alt"></i> <span>Instalar Dona Ant√¥nia Cestas como App!</span>
    </div>

    <!-- CONTAINER DE CONTE√öDO PRINCIPAL -->
    <div class="main-content-wrapper">
        
        <!-- SE√á√ÉO 1: PRODUTOS (Cestas) -->
        <div id="pag-cestas" class="secao-conteudo">
            <div class="card" style="text-align: center; background-color: #fff3e0;">
                <h1 style="margin: 0; font-size: 1.1rem; font-weight: bold; color: #E65100;">
                    üëë 8 anos de tradi√ß√£o em Cuiab√° e VG
                </h1>
                <p style="margin: 5px 0 0 0; font-size: 0.9rem; color: #666;">Cestas b√°sicas com pre√ßo justo e qualidade garantida.</p>
            </div>

            <!-- GRID PARA OS CARDS DE CESTA -->
            <div class="cesta-cards-grid">
                
                <!-- PRODUTO 1: CESTA ECON√îMICA (1 PRE√áO) -->
                <div class="card card-cesta">
                    <div class="cesta-header"><h3>CESTA ECON√îMICA</h3></div>
                    <div class="cesta-body">
                        <!-- Galeria de 2 Fotos Quadradas -->
                        <div class="galeria-fotos" id="galeria-economica">
                            <!-- Imagem 1 (CONECTADO: img/cesta-economica1.jpg) -->
                            <div class="img-wrapper active" data-img-index="0">
                                <img src="img/cesta-economica1.jpg" alt="Cesta Econ√¥mica" loading="lazy" onerror="this.src='https://placehold.co/400x400?text=ECON√îMICA+1'">
                            </div>
                            <!-- Imagem 2 (CONECTADO: img/cesta-economica2.jpg) -->
                            <div class="img-wrapper" data-img-index="1">
                                <img src="img/cesta-economica2.jpg" alt="Cesta Econ√¥mica Detalhe" loading="lazy" onerror="this.src='https://placehold.co/400x400?text=ECON√îMICA+2'">
                            </div>
                            <!-- Bot√£o de Navega√ß√£o entre fotos -->
                            <div class="swipe-indicator" onclick="event.stopPropagation(); mudarFotoNoCard('economica')">
                                <span id="btn-foto-economica">VER PRODUTOS</span>
                            </div>
                        </div>
                        <div class="lista-precos-cesta">
                            <div class="item-preco"><span>Com Arroz Tio Alvino:</span><strong>R$ 85,00</strong></div>
                        </div>
                        <div class="botoes-wrapper">
                            <!-- BOT√ÉO √öNICO: Envia direto para WhatsApp (Pre√ßo √∫nico) -->
                            <button class="btn" onclick="encomendarDireto('Cesta Econ√¥mica', '85,00')">
                                <i class="fab fa-whatsapp" style="margin-right: 8px;"></i> Encomendar
                            </button>
                        </div>
                        <p style="text-align: center; font-size: 13px; color: #555; margin-top: 10px;">
                            Garanta o Amaciante Ype de 2 Litros de Brinde!
                        </p>
                    </div>
                </div>

                <!-- PRODUTO 2: CESTA MINI (2 PRE√áOS) -->
                <div class="card card-cesta">
                    <div class="cesta-header"><h3>CESTA MINI</h3></div>
                    <div class="cesta-body">
                        <!-- Galeria de 2 Fotos Quadradas -->
                        <div class="galeria-fotos" id="galeria-mini">
                            <!-- Imagem 1 (CONECTADO: img/cesta-mini1.jpg) -->
                            <div class="img-wrapper active" data-img-index="0">
                                <img src="img/cesta-mini1.jpg" alt="Cesta Mini" loading="lazy" onerror="this.src='https://placehold.co/400x400?text=MINI+1'">
                            </div>
                            <!-- Imagem 2 (CONECTADO: img/cesta-mini2.jpg) -->
                            <div class="img-wrapper" data-img-index="1">
                                <img src="img/cesta-mini2.jpg" alt="Cesta Mini Detalhe" loading="lazy" onerror="this.src='https://placehold.co/400x400?text=MINI+2'">
                            </div>
                            <div class="swipe-indicator" onclick="event.stopPropagation(); mudarFotoNoCard('mini')">
                                <span id="btn-foto-mini">VER PRODUTOS</span>
                            </div>
                        </div>
                        <div class="lista-precos-cesta">
                            <div class="item-preco"><span>Com Arroz Tio Alvino:</span><strong>R$ 165,00</strong></div>
                            <div class="item-preco"><span>Com Arroz Koblenz:</span><strong>R$ 170,00</strong></div>
                        </div>
                        <div class="botoes-wrapper">
                            <!-- BOT√ÉO √öNICO: Abre modal para escolha da varia√ß√£o -->
                            <button class="btn" onclick="abrirModalVariacao('Cesta Mini', '165,00', '170,00')">
                                <i class="fab fa-whatsapp" style="margin-right: 8px;"></i> Encomendar
                            </button>
                        </div>
                        <p style="text-align: center; font-size: 13px; color: #555; margin-top: 10px;">
                            Garanta o Amaciante Ype de 2 Litros de Brinde!
                        </p>
                    </div>
                </div>

                <!-- PRODUTO 3: CESTA PEQUENA (2 PRE√áOS) -->
                <div class="card card-cesta">
                    <div class="cesta-header"><h3>CESTA PEQUENA</h3></div>
                    <div class="cesta-body">
                        <!-- Galeria de 2 Fotos Quadradas -->
                        <div class="galeria-fotos" id="galeria-pequena">
                            <!-- Imagem 1 (CONECTADO: img/cesta-pequena1.jpg) -->
                            <div class="img-wrapper active" data-img-index="0">
                                <img src="img/cesta-pequena1.jpg" alt="Cesta Pequena" loading="lazy" onerror="this.src='https://placehold.co/400x400?text=PEQUENA+1'">
                            </div>
                            <!-- Imagem 2 (CONECTADO: img/cesta-pequena2.jpg) -->
                            <div class="img-wrapper" data-img-index="1">
                                <img src="img/cesta-pequena2.jpg" alt="Cesta Pequena Detalhe" loading="lazy" onerror="this.src='https://placehold.co/400x400?text=PEQUENA+2'">
                            </div>
                            <div class="swipe-indicator" onclick="event.stopPropagation(); mudarFotoNoCard('pequena')">
                                <span id="btn-foto-pequena">VER PRODUTOS</span>
                            </div>
                        </div>
                        <div class="lista-precos-cesta">
                            <div class="item-preco"><span>Com Arroz Tio Alvino:</span><strong>R$ 215,00</strong></div>
                            <div class="item-preco"><span>Com Arroz Koblenz:</span><strong>R$ 220,00</strong></div>
                        </div>
                        <div class="botoes-wrapper">
                            <!-- BOT√ÉO √öNICO: Abre modal para escolha da varia√ß√£o -->
                            <button class="btn" onclick="abrirModalVariacao('Cesta Pequena', '215,00', '220,00')">
                                <i class="fab fa-whatsapp" style="margin-right: 8px;"></i> Encomendar
                            </button>
                        </div>
                        <p style="text-align: center; font-size: 13px; color: #555; margin-top: 10px;">
                            Garanta o Amaciante Ype de 2 Litros de Brinde!
                        </p>
                    </div>
                </div>

                <!-- PRODUTO 4: CESTA M√âDIA (2 PRE√áOS) -->
                <div class="card card-cesta">
                    <div class="cesta-header"><h3>CESTA M√âDIA</h3></div>
                    <div class="cesta-body">
                        <!-- Galeria de 2 Fotos Quadradas -->
                        <div class="galeria-fotos" id="galeria-media">
                            <!-- Imagem 1 (CONECTADO: img/cesta-media1.jpg) -->
                            <div class="img-wrapper active" data-img-index="0">
                                <img src="img/cesta-media1.jpg" alt="Cesta M√©dia" loading="lazy" onerror="this.src='https://placehold.co/400x400?text=M√âDIA+1'">
                            </div>
                            <!-- Imagem 2 (CONECTADO: img/cesta-media2.jpg) -->
                            <div class="img-wrapper" data-img-index="1">
                                <img src="img/cesta-media2.jpg" alt="Cesta M√©dia Detalhe" loading="lazy" onerror="this.src='https://placehold.co/400x400?text=M√âDIA+2'">
                            </div>
                            <div class="swipe-indicator" onclick="event.stopPropagation(); mudarFotoNoCard('media')">
                                <span id="btn-foto-media">VER PRODUTOS</span>
                            </div>
                        </div>
                        <div class="lista-precos-cesta">
                            <div class="item-preco"><span>Com Arroz Tio Alvino:</span><strong>R$ 320,00</strong></div>
                            <div class="item-preco"><span>Com Arroz Koblenz:</span><strong>R$ 325,00</strong></div>
                        </div>
                        <div class="botoes-wrapper">
                            <!-- BOT√ÉO √öNICO: Abre modal para escolha da varia√ß√£o -->
                            <button class="btn" onclick="abrirModalVariacao('Cesta M√©dia', '320,00', '325,00')">
                                <i class="fab fa-whatsapp" style="margin-right: 8px;"></i> Encomendar
                            </button>
                        </div>
                        <p style="text-align: center; font-size: 13px; color: #555; margin-top: 10px;">
                            Garanta o Amaciante Ype de 2 Litros de Brinde!
                        </p>
                    </div>
                </div>

                <!-- PRODUTO 5: CESTA GRANDE (2 PRE√áOS) -->
                <div class="card card-cesta">
                    <div class="cesta-header"><h3>CESTA GRANDE</h3></div>
                    <div class="cesta-body">
                        <!-- Galeria de 2 Fotos Quadradas -->
                        <div class="galeria-fotos" id="galeria-grande">
                            <!-- Imagem 1 (CONECTADO: img/cesta-grande1.jpg) -->
                            <div class="img-wrapper active" data-img-index="0">
                                <img src="img/cesta-grande1.jpg" alt="Cesta B√°sica Grande" onerror="this.src='https://placehold.co/400x400?text=GRANDE+1'">
                            </div>
                            <!-- Imagem 2 (CONECTADO: img/cesta-grande2.jpg) -->
                            <div class="img-wrapper" data-img-index="1">
                                <img src="img/cesta-grande2.jpg" alt="Cesta B√°sica Grande Detalhe" onerror="this.src='https://placehold.co/400x400?text=GRANDE+2'">
                            </div>
                            <div class="swipe-indicator" onclick="event.stopPropagation(); mudarFotoNoCard('grande')">
                                <span id="btn-foto-grande">VER PRODUTOS</span>
                            </div>
                        </div>
                        <div class="lista-precos-cesta">
                            <div class="item-preco"><span>Com Arroz Tio Alvino:</span><strong>R$ 380,00</strong></div>
                            <div class="item-preco"><span>Com Arroz Koblenz:</span><strong>R$ 390,00</strong></div>
                        </div>
                        <div class="botoes-wrapper">
                            <!-- BOT√ÉO √öNICO: Abre modal para escolha da varia√ß√£o -->
                            <button class="btn" onclick="abrirModalVariacao('Cesta Grande', '380,00', '390,00')">
                                <i class="fab fa-whatsapp" style="margin-right: 8px;"></i> Encomendar
                            </button>
                        </div>
                        <p style="text-align: center; font-size: 13px; color: #555; margin-top: 10px;">
                            Garanta o Amaciante Ype de 2 Litros de Brinde!
                        </p>
                    </div>
                </div>
            </div><!-- FIM GRID PRODUTOS -->
        </div><!-- FIM SE√á√ÉO CESTAS -->
        
        <!-- SE√á√ÉO 2 & 3: PAGAMENTO E SORTEIO (Usando grid no desktop) -->
        <div class="secoes-extras-grid">
            
            <!-- CARD 1: FORMAS DE PAGAMENTO (EXTRA√çDO DO ANEXO) -->
            <div id="pag-pagamento" class="secao-conteudo">
                <div class="section-icon-header">
                    <!-- √çCONE PAGAMENTO (CONECTADO: img/pagamento.png) -->
                    <img src="img/pagamento.png" alt="Pagamento Icone" onerror="this.onerror=null;this.src='https://placehold.co/60x60/2196F3/ffffff?text=P'">
                </div>
                <div class="card">
                    <h2>üí≥ Formas de Pagamento</h2>
                    <ul class="lista-pagamento">
                        <li><span class="emoji-icon">üíµ</span> Dinheiro</li>
                        <li><span class="emoji-icon">‚ú®</span> Pix</li>
                        <li><span class="emoji-icon">üí≥</span> Cart√£o de D√©bito</li>
                        <li><span class="emoji-icon">üí≥</span> Cart√£o de Cr√©dito (at√© 3x sem juros)</li>
                        <li><span class="emoji-icon">ü•ó</span> Alelo Alimenta√ß√£o/Refei√ß√£o</li>
                        <li><span class="emoji-icon">ü•ó</span> Sodexo Alimenta√ß√£o/Refei√ß√£o</li>
                        <li><span class="emoji-icon">ü•ó</span> Pluxee Alimenta√ß√£o/Refei√ß√£o</li>
                        <li><span class="emoji-icon">üì±</span> Ifood Benef√≠cios, Caju e Flash</li>
                    </ul>
                    <p style="color: red; font-size: 18px; text-align: center; margin-top: 20px;"><strong>‚ö†Ô∏è Aten√ß√£o:</strong> N√£o vendemos a prazo para 30 dias.</p>
                </div>
            </div>

            <!-- CARD 2: CADASTRO PARA SORTEIO (EXTRA√çDO DO ANEXO) -->
            <div id="pag-sorteio" class="secao-conteudo">
                <div class="section-icon-header">
                    <!-- √çCONE SORTEIO (CONECTADO: img/cesta.png) -->
                    <img src="img/cesta.png" alt="Sorteio Icone" onerror="this.onerror=null;this.src='https://placehold.co/60x60/4CAF50/ffffff?text=S'">
                </div>
                <div class="card">
                    <h2>üéâ Sorteio todo Domingo.</h2>
                    <p>Pr√≥ximo Sorteio dia 7 de Dezembro as 18h. V√°lido para moradores de Cuiab√° e VG</p>
                    
                    <!-- ETAPA 1: BUSCA POR TELEFONE -->
                    <div id="area-busca-telefone" class="card" style="margin-bottom: 15px;">
                        <h2>üçÄ Participe</h2>
                        <label>Telefone (Whatsapp): <span style="color:red">*</span></label>
                        <input type="tel" id="busca-telefone" placeholder="Digite seu telefone..." required>
                        <button onclick="buscarCadastro()" class="btn" style="background-color: var(--cor-primaria); margin-top: 5px;">
                            <i class="fas fa-search" style="margin-right: 8px;"></i> Participar
                        </button>
                    </div>

                    <!-- ETAPA 2A: CADASTRO ENCONTRADO (Escondido inicialmente) -->
                    <div id="cadastro-encontrado" class="area-resultado-busca" style="display: none;">
                        <h2>‚úÖ Cadastro Encontrado!</h2>
                        <p style="margin-bottom: 10px;">Confira seus dados:</p>
                        
                        <div style="text-align: left;">
                            <p><strong>Nome:</strong> <span id="nome-cliente-encontrado"></span></p>
                            <p><strong>Cidade:</strong> <span id="cidade-cliente-encontrado"></span></p>
                            <p><strong>Bairro:</strong> <span id="bairro-cliente-encontrado"></span></p>
                        </div>
                        
                        <button onclick="confirmarJaCadastrado()" class="btn" style="background-color: var(--cor-whatsapp); margin-top: 15px;">
                            <i class="fab fa-whatsapp" style="margin-right: 8px;"></i> Confirmar e Participar
                        </button>
                    </div>
                    
                    <!-- ETAPA 2B: NOVO CADASTRO (Escondido inicialmente) -->
                    <div id="cadastro-novo" class="card" style="display: none; background-color: #fff3e0; border: 1px solid #ffcc80;">
                        <h2>üìù Novo Cadastro</h2>
                        <p style="margin-bottom: 15px; color: #D32F2F;">N√£o encontramos seu n√∫mero. Preencha seus dados para participar:</p>
                        
                        <form onsubmit="event.preventDefault(); enviarNovoCadastro();">
                            <label>Nome Completo: <span style="color:red">*</span></label>
                            <input type="text" id="novo-nome" placeholder="Seu nome" required>
                            <label>Telefone (Whatsapp): <span style="color:red">*</span></label>
                            <input type="tel" id="novo-telefone" placeholder="(65) 9..." required disabled> 
                            <label>Cidade: <span style="color:red">*</span></label>
                            <select id="novo-cidade" required>
                                <option value="">Selecione...</option>
                                <option value="Cuiab√°">Cuiab√°</option>
                                <option value="V√°rzea Grande">V√°rzea Grande</option>
                            </select>
                            <label>Bairro: <span style="color:red">*</span></label>
                            <input type="text" id="novo-bairro" placeholder="Seu bairro" required>
                            <button type="submit" class="btn"><i class="fab fa-whatsapp" style="margin-right: 8px;"></i> Cadastrar e Participar</button>
                        </form>
                    </div>

                </div>
            </div>

        </div><!-- FIM SE√á√ïES EXTRAS GRID -->

        <div class="seo-text-block" style="text-align: center; font-size: 12px; color: #888; padding: 15px 30px;">
            <p><strong>Cesta B√°sica Dona Ant√¥nia</strong> - A melhor op√ß√£o em alimentos para sua fam√≠lia. Atendemos com rapidez e qualidade os bairros: CPA 1, 2, 3 e 4, Tijucal, Pedra 90, Osmar Cabral, Parque Cuiab√°, Cristo Rei, Mapim e toda a Grande Cuiab√° e V√°rzea Grande.</p>
        </div>
        
    </div><!-- FIM MAIN-CONTENT-WRAPPER -->

    <!-- MODAL DE ESCOLHA DE VARIA√á√ÉO (MANTIDO) -->
    <div id="modalVariacao" class="modal-variacao" onclick="if(event.target === this) fecharModalVariacao()">
        <div class="modal-variacao-content">
            <button class="btn-fechar-modal-var" onclick="fecharModalVariacao()">&times;</button>
            
            <h3 class="titulo-modal-var" id="tituloCestaModal">Cesta X</h3>
            <p class="subtitulo-modal-var">Escolha a marca do arroz para continuar:</p>
            
            <div class="opcao-select" id="optAlvino" onclick="selecionarOpcao('alvino')">
                <div class="opcao-info">
                    <span class="opcao-nome">Arroz Tio Alvino</span>
                    <span class="opcao-preco" id="precoAlvinoDisplay">R$ 0,00</span>
                </div>
                <div class="radio-custom"></div>
            </div>

            <div class="opcao-select" id="optKoblenz" onclick="selecionarOpcao('koblenz')">
                <div class="opcao-info">
                    <span class="opcao-nome">Arroz Koblenz</span>
                    <span class="opcao-preco" id="precoKoblenzDisplay">R$ 0,00</span>
                </div>
                <div class="radio-custom"></div>
            </div>

            <button class="btn-confirmar-pedido" id="btnConfirmarPedido" onclick="confirmarAcao()" disabled>
                <i class="fab fa-whatsapp"></i> Enviar Pedido
            </button>
        </div>
    </div>

    <!-- NOVO MODAL: POPUP RECEPTIVO E FUNIL EM DUAS ETAPAS -->
    <div id="modalReceptivo" onclick="if(event.target === this) fecharModalReceptivo()" class="modal-variacao">
        <div class="modal-receptivo-content">
            
            <!-- ETAPA 1: LOCALIZA√á√ÉO E VELOCIDADE -->
            <div id="etapa1" class="etapa-modal ativa">
                <img src="uploaded:icon-512.jpg-e6b1d93e-bd40-4cbe-8eb9-1ce2d7412765" 
                     alt="Logo Dona Ant√¥nia" 
                     style="width: 80px; height: 80px; border-radius: 50%; margin-bottom: 15px; box-shadow: 0 4px 10px rgba(0,0,0,0.2);">
                <h3 class="titulo-receptivo">BEM-VINDO! üëã</h3>
                <p class="subtitulo-receptivo">
                    Entregamos em Cuiab√° e V√°rzea Grande. Encomende pela manh√£ e receba sua cesta no mesmo dia!
                </p>
                <button class="btn-receptivo btn-ver-cestas" onclick="mudarEtapaPopup()">
                    <i class="fas fa-box" style="margin-right: 8px;"></i> Ver as Cestas
                </button>
                <button onclick="fecharModalReceptivo()" style="background: none; border: none; color: #999; margin-top: 10px; font-size: 14px; cursor: pointer;">
                    Fechar e Continuar
                </button>
            </div>

            <!-- ETAPA 2: BRINDE E CTA DIRETA -->
            <div id="etapa2" class="etapa-modal">
                <i class="fas fa-gift" style="font-size: 50px; color: var(--cor-whatsapp); margin-bottom: 15px;"></i>
                <h3 class="titulo-receptivo" style="color: var(--cor-whatsapp);">üéâ Ah, e tem mais!</h3>
                <p class="subtitulo-receptivo">
                    Na sua primeira compra, vamos te dar um Amaciante Yp√™ de 2 Litros de Brinde!
                </p>
                <!-- O bot√£o agora leva direto para o WhatsApp com uma mensagem de brinde -->
                <button class="btn-receptivo btn-eu-quero" onclick="confirmarBrindeEWhatsApp()">
                    <i class="fab fa-whatsapp" style="margin-right: 8px;"></i> EU QUERO o Brinde!
                </button>
                <button onclick="fecharModalReceptivo()" style="background: none; border: none; color: #999; margin-top: 10px; font-size: 14px; cursor: pointer;">
                    Voltar para o site
                </button>
            </div>

        </div>
    </div>
    
    <!-- SCRIPT JS PRINCIPAL -->
    <script>
        // Tenta carregar o arquivo de clientes (data/clientes.js)
        var clientes = [];
    </script>
    <script src="data/clientes.js" onerror="console.warn('Arquivo data/clientes.js n√£o encontrado. Usando dados de simula√ß√£o.')"></script>

    <script>
        // Instru√ß√µes Detalhadas e Documenta√ß√£o
        
        // N√∫mero de telefone para contato via WhatsApp (998150975)
        const TELEFONE = "5565998150975"; 
        
        // Vari√°vel para armazenar o prompt de instala√ß√£o adiado do PWA
        let deferredPrompt; 
        
        // Vari√°veis globais para o modal de varia√ß√£o
        let dadosCestaAtual = { nome: '', precoAlvino: '', precoKoblenz: '' };
        let opcaoEscolhida = ''; 

        // ===============================
        // === NOVO: L√ìGICA DO POPUP RECEPTIVO EM 2 ETAPAS ===
        // ===============================
        
        const MODAL_RECEPTIVO_KEY = 'donaAntoniaVisitou';
        
        /**
         * 1. Exibe o modal receptivo se for a primeira visita do usu√°rio.
         */
        function iniciarPopupReceptivo() {
            // Verifica se o usu√°rio j√° visitou o site (se a chave est√° no localStorage)
            if (localStorage.getItem(MODAL_RECEPTIVO_KEY) !== 'sim') {
                document.getElementById('modalReceptivo').style.display = 'flex';
            }
        }

        /**
         * 2. Fecha o modal e marca no localStorage que o usu√°rio j√° o viu.
         */
        function fecharModalReceptivo() {
            document.getElementById('modalReceptivo').style.display = 'none';
            // Marca a visita no localStorage
            localStorage.setItem(MODAL_RECEPTIVO_KEY, 'sim');
            
            // Rola a p√°gina para a se√ß√£o de cestas ap√≥s fechar
            document.getElementById('pag-cestas').scrollIntoView({ behavior: 'smooth' });
        }
        
        /**
         * 3. Altera o conte√∫do do modal da Etapa 1 para a Etapa 2.
         * Esta √© a fun√ß√£o chamada pelo bot√£o "Ver as Cestas".
         */
        function mudarEtapaPopup() {
            const etapa1 = document.getElementById('etapa1');
            const etapa2 = document.getElementById('etapa2');
            
            // Remove a classe ativa da Etapa 1 e adiciona na Etapa 2
            etapa1.classList.remove('ativa');
            etapa2.classList.add('ativa');
        }
        
        /**
         * 4. Envia o cliente para o WhatsApp com a mensagem do brinde.
         * Esta √© a fun√ß√£o chamada pelo bot√£o "EU QUERO o Brinde!".
         */
        function confirmarBrindeEWhatsApp() {
            // Marca a visita no localStorage antes de sair (para n√£o reabrir)
            localStorage.setItem(MODAL_RECEPTIVO_KEY, 'sim'); 
            
            const textoZap = `Ol√°, vim pelo an√∫ncio e pelo popup de boas-vindas! Quero fazer minha *primeira compra* para garantir o Amaciante Yp√™ de 2L de brinde.`;
            
            // Abre o WhatsApp e fecha o modal
            window.open(`https://wa.me/${TELEFONE}?text=${encodeURIComponent(textoZap)}`, '_blank'); 
            fecharModalReceptivo();
        }


        // ===============================
        // === L√ìGICA DE INSTALA√á√ÉO PWA (MANTIDA) ===
        // ===============================
        
        /**
         * 1. Registra o Service Worker (Essencial para PWA e funcionamento offline)
         */
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./service-worker.js')
                    .then(registration => {
                        console.log('Service Worker registrado com sucesso: ', registration.scope);
                    })
                    .catch(error => {
                        console.log('Falha no registro do Service Worker: ', error);
                    });
            });
        }


        /**
         * 2. Captura o evento de instala√ß√£o (beforeinstallprompt)
         * O navegador dispara este evento quando o PWA √© eleg√≠vel para instala√ß√£o.
         */
        window.addEventListener('beforeinstallprompt', (e) => {
            // Previne que o mini-infobar padr√£o do Chrome apare√ßa
            e.preventDefault();
            // Armazena o evento para que possa ser disparado mais tarde
            deferredPrompt = e;
            // Exibe o banner de instala√ß√£o customizado
            const banner = document.getElementById('pwa-install-banner');
            const body = document.body;
            
            // Define o banner como vis√≠vel e ajusta o padding do body
            banner.style.display = 'flex';
            body.classList.add('pwa-active');

            console.log("Evento 'beforeinstallprompt' capturado. Banner de instala√ß√£o customizado vis√≠vel.");
        });

        /**
         * 3. Fun√ß√£o chamada ao clicar no banner para iniciar a instala√ß√£o.
         */
        function instalarPWA() {
            if (deferredPrompt) {
                // Esconde o banner de instala√ß√£o
                const banner = document.getElementById('pwa-install-banner');
                const body = document.body;

                banner.style.display = 'none';
                body.classList.remove('pwa-active');

                // Chama o prompt de instala√ß√£o do navegador
                deferredPrompt.prompt();
                
                // Espera o usu√°rio responder ao prompt
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        // Limpa o prompt adiado, pois foi usado
                        deferredPrompt = null;
                        mostrarMensagemBusca("üéâ Aplicativo instalado com sucesso!", false);
                    } else {
                        // Se o usu√°rio recusar, o banner pode reaparecer no pr√≥ximo 'beforeinstallprompt'
                        mostrarMensagemBusca("Instala√ß√£o cancelada. Voc√™ pode tentar novamente mais tarde.", true);
                    }
                });
            } else {
                 mostrarMensagemBusca("O aplicativo j√° est√° instalado ou o navegador n√£o suporta a instala√ß√£o PWA.", true);
            }
        }

        // ===============================
        // === L√ìGICA DE PRODUTOS/MODAL (MANTIDA) ===
        // ===============================
        
        /**
         * Envia o pedido direto para o WhatsApp (para produtos sem varia√ß√£o).
         * @param {string} produto - Nome do produto (ex: Cesta Econ√¥mica).
         * @param {string} preco - Pre√ßo do produto (ex: 85,00).
         */
        function encomendarDireto(produto, preco) { 
            const textoZap = `Ol√°, quero encomendar a *${produto}* (Valor: R$ ${preco}). Com Amaciante Yp√™ de 2L de brinde.`;
            window.open(`https://wa.me/${TELEFONE}?text=${encodeURIComponent(textoZap)}`, '_blank'); 
        }
        
        /**
         * Abre o modal de escolha de varia√ß√£o (para produtos com 2 pre√ßos).
         * @param {string} nome - Nome do produto.
         * @param {string} pAlvino - Pre√ßo da varia√ß√£o Tio Alvino.
         * @param {string} pKoblenz - Pre√ßo da varia√ß√£o Koblenz.
         */
        function abrirModalVariacao(nome, pAlvino, pKoblenz) { 
            // 1. Armazena os dados atuais
            dadosCestaAtual = { nome, precoAlvino: pAlvino, precoKoblenz: pKoblenz };
            opcaoEscolhida = '';
            
            // 2. Preenche o modal
            document.getElementById('tituloCestaModal').innerText = nome;
            document.getElementById('precoAlvinoDisplay').innerText = 'R$ ' + pAlvino;
            document.getElementById('precoKoblenzDisplay').innerText = 'R$ ' + pKoblenz;
            
            // 3. Reseta o estado do modal
            document.getElementById('optAlvino').classList.remove('selected');
            document.getElementById('optKoblenz').classList.remove('selected');
            document.getElementById('btnConfirmarPedido').disabled = true;

            // 4. Exibe o modal
            document.getElementById('modalVariacao').style.display = 'flex';
        }

        /**
         * Seleciona uma op√ß√£o de varia√ß√£o dentro do modal.
         * @param {string} tipo - 'alvino' ou 'koblenz'.
         */
        function selecionarOpcao(tipo) {
            opcaoEscolhida = tipo;
            
            // Remove a sele√ß√£o de ambos e adiciona √† op√ß√£o correta
            document.getElementById('optAlvino').classList.remove('selected');
            document.getElementById('optKoblenz').classList.remove('selected');
            
            if(tipo === 'alvino') {
                document.getElementById('optAlvino').classList.add('selected');
            } else {
                document.getElementById('optKoblenz').classList.add('selected');
            }
            
            // Habilita o bot√£o de confirma√ß√£o
            document.getElementById('btnConfirmarPedido').disabled = false;
        }

        /**
         * Confirma a escolha no modal e envia o pedido para o WhatsApp.
         */
        function confirmarAcao() {
            if(!opcaoEscolhida) return; // Garante que uma op√ß√£o foi escolhida

            let marca = opcaoEscolhida === 'alvino' ? 'Arroz Tio Alvino' : 'Arroz Koblenz';
            let preco = opcaoEscolhida === 'alvino' ? dadosCestaAtual.precoAlvino : dadosCestaAtual.precoKoblenz;
            let nomeCesta = dadosCestaAtual.nome;
            
            let textoZap = `Ol√°, quero encomendar a *${nomeCesta}* com *${marca}* (Valor: R$ ${preco}). Com Amaciante Yp√™ de 2L de brinde.`;
            
            window.open(`https://wa.me/${TELEFONE}?text=${encodeURIComponent(textoZap)}`, '_blank');
            fecharModalVariacao();
        }

        /**
         * Fecha o modal de varia√ß√£o.
         */
        function fecharModalVariacao() {
            document.getElementById('modalVariacao').style.display = 'none';
        }
        
        // ===============================
        // === L√ìGICA DE GALERIA DE FOTOS (MANTIDA) ===
        // ===============================
        
        const CestaImages = {
            'economica': 2, 'mini': 2, 'pequena': 2, 'media': 2, 'grande': 2,
        };
        let currentPhotoIndex = {
            'economica': 0, 'mini': 0, 'pequena': 0, 'media': 0, 'grande': 0
        };
        
        /**
         * Atualiza o texto do bot√£o de navega√ß√£o (VER PRODUTOS / VER FOTO).
         * @param {string} cestaTipo - Tipo da cesta.
         * @param {number} newIndex - √çndice da foto atual.
         */
        function updatePhotoIndicator(cestaTipo, newIndex) {
            const indicatorSpan = document.querySelector(`#galeria-${cestaTipo} .swipe-indicator span`);
            if (indicatorSpan) {
                if (newIndex === 0) {
                    indicatorSpan.innerText = 'VER PRODUTOS';
                } else {
                    indicatorSpan.innerText = 'VER FOTO';
                }
            }
        }

        /**
         * Alterna a foto vis√≠vel em um card de produto.
         * @param {string} cestaTipo - Tipo da cesta (ex: 'mini').
         */
        function mudarFotoNoCard(cestaTipo) {
            const galeria = document.getElementById(`galeria-${cestaTipo}`);
            if (!galeria || !CestaImages[cestaTipo] || CestaImages[cestaTipo] < 2) return;

            const totalImages = CestaImages[cestaTipo];
            let newIndex = (currentPhotoIndex[cestaTipo] + 1) % totalImages;
            
            // Remove 'active' da foto atual
            const currentWrapper = galeria.querySelector(`.img-wrapper.active`);
            if (currentWrapper) {
                currentWrapper.classList.remove('active');
            }

            // Adiciona 'active' na nova foto
            const newWrapper = galeria.querySelector(`.img-wrapper[data-img-index="${newIndex}"]`);
            if (newWrapper) {
                newWrapper.classList.add('active');
            } else {
                // Fallback de seguran√ßa
                galeria.querySelector(`.img-wrapper[data-img-index="0"]`).classList.add('active');
                newIndex = 0;
            }

            currentPhotoIndex[cestaTipo] = newIndex;
            updatePhotoIndicator(cestaTipo, newIndex);
        }

        // ===============================
        // === L√ìGICA DE SORTEIO (MANTIDA) ===
        // ===============================
        
        const cadastroEncontradoDiv = document.getElementById('cadastro-encontrado');
        const cadastroNovoDiv = document.getElementById('cadastro-novo');
        const buscaTelefoneInput = document.getElementById('busca-telefone');
        const areaBuscaTelefoneDiv = document.getElementById('area-busca-telefone');

        /**
         * Exibe uma mensagem de aten√ß√£o/sucesso tempor√°ria. (Substitui alert())
         * @param {string} msg - A mensagem a ser exibida.
         * @param {boolean} isError - Se √© uma mensagem de erro (true) ou sucesso (false).
         */
        function mostrarMensagemBusca(msg, isError = true) {
            // Cria um modal ou utiliza uma √°rea tempor√°ria para notifica√ß√£o
            // Usaremos temporariamente a √°rea de cadastro encontrado para mensagens
            const originalContent = cadastroEncontradoDiv.innerHTML;
            
            // Previne que a mensagem tempor√°ria tente disparar a l√≥gica do sorteio
            cadastroEncontradoDiv.style.pointerEvents = 'none'; 
            
            cadastroEncontradoDiv.innerHTML = `<h2>${isError ? '‚ö†Ô∏è Aten√ß√£o!' : 'üéâ Sucesso!'}</h2><p>${msg}</p>`;
            cadastroEncontradoDiv.style.backgroundColor = isError ? '#ffebee' : '#e8f5e9';
            cadastroEncontradoDiv.style.borderColor = isError ? '#ffcdd2' : '#a5d6a7';
            cadastroEncontradoDiv.style.display = 'block';
            
            setTimeout(() => { 
                cadastroEncontradoDiv.style.display = 'none'; 
                cadastroEncontradoDiv.innerHTML = originalContent; // Restaura o conte√∫do original
                cadastroEncontradoDiv.style.pointerEvents = 'auto'; // Restaura a interatividade
            }, 3000);
        }
        
        /**
         * Busca o telefone digitado na base de clientes (data/clientes.js).
         */
        function buscarCadastro() {
            cadastroEncontradoDiv.style.display = 'none';
            cadastroNovoDiv.style.display = 'none';

            const inputTel = buscaTelefoneInput.value;
            const telLimpo = inputTel.replace(/\D/g, ''); 
            
            if (!telLimpo || telLimpo.length < 6) {
                mostrarMensagemBusca("Por favor, digite o n√∫mero completo ou os √∫ltimos 6 d√≠gitos do seu telefone.");
                return;
            }

            const btnBuscar = areaBuscaTelefoneDiv.querySelector('.btn');
            const textoOriginal = btnBuscar.innerHTML;
            btnBuscar.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Buscando...';
            btnBuscar.disabled = true;

            // Simula√ß√£o de delay de busca
            setTimeout(() => {
                btnBuscar.innerHTML = textoOriginal;
                btnBuscar.disabled = false;
                
                let clienteEncontrado = null;
                
                // Cliente deve ser procurado na vari√°vel global 'clientes'
                if(typeof clientes !== 'undefined' && Array.isArray(clientes)) {
                     const inputSuffix = telLimpo.slice(-6);
                     clienteEncontrado = clientes.find(c => {
                        const cTelLimpo = c.telefone.replace(/\D/g, '');
                        if (cTelLimpo.length < 6) return false;
                        const clientSuffix = cTelLimpo.slice(-6);
                        return clientSuffix === inputSuffix;
                    });
                }
                
                if (clienteEncontrado) {
                    document.getElementById('nome-cliente-encontrado').innerText = clienteEncontrado.nome;
                    document.getElementById('cidade-cliente-encontrado').innerText = clienteEncontrado.cidade;
                    document.getElementById('bairro-cliente-encontrado').innerText = clienteEncontrado.bairro;
                    
                    // Armazena dados para a confirma√ß√£o
                    buscaTelefoneInput.setAttribute('data-nome-encontrado', clienteEncontrado.nome);
                    buscaTelefoneInput.setAttribute('data-cidade-encontrada', clienteEncontrado.cidade);
                    buscaTelefoneInput.setAttribute('data-bairro-encontrado', clienteEncontrado.bairro);
                    
                    cadastroEncontradoDiv.style.display = 'block';
                    
                } else {
                    const novoTelefoneInput = document.getElementById('novo-telefone');
                    novoTelefoneInput.value = inputTel; 
                    document.getElementById('novo-telefone').disabled = true; // Desabilita edi√ß√£o do telefone aqui
                    cadastroNovoDiv.style.display = 'block';
                }
                
            }, 600); 
        }

        /**
         * Envia os dados do novo cadastro para o WhatsApp.
         */
        function enviarNovoCadastro() {
            const nome = document.getElementById('novo-nome').value.trim();
            const tel = document.getElementById('novo-telefone').value.trim(); 
            const cid = document.getElementById('novo-cidade').value;
            const bai = document.getElementById('novo-bairro').value.trim();
            
            if (!nome || !tel || !cid || !bai) { mostrarMensagemBusca("Preencha todos os campos do novo cadastro!", true); return; }
            
            const msg = `CADASTRO SORTEIO:\nNome: ${nome}\nTel: ${tel}\nCidade: ${cid}\nBairro: ${bai}\n\nSolicito participa√ß√£o no sorteio.`;
            
            window.open(`https://wa.me/${TELEFONE}?text=${encodeURIComponent(msg)}`, '_blank');
        }

        /**
         * Confirma o cadastro existente e envia a confirma√ß√£o para o WhatsApp.
         */
        function confirmarJaCadastrado() {
            const tel = buscaTelefoneInput.value;
            const nome = buscaTelefoneInput.getAttribute('data-nome-encontrado') || "Cliente";
            const cidade = buscaTelefoneInput.getAttribute('data-cidade-encontrada') || "N/A";
            const bairro = buscaTelefoneInput.getAttribute('data-bairro-encontrado') || "N/A";
            
            const msg = `J√Å SOU CADASTRADO:\nNome: ${nome}\nTelefone: ${tel}\nCidade: ${cidade}\nBairro: ${bairro}\n\nConfirmo minha participa√ß√£o no Sorteio.`;
            
            window.open(`https://wa.me/${TELEFONE}?text=${encodeURIComponent(msg)}`, '_blank');
        }

        // ===============================
        // === L√ìGICA DE CARREGAMENTO INICIAL ===
        // ===============================

        /**
         * Ajusta a posi√ß√£o da logo e do cabe√ßalho no desktop para ficarem centralizados
         * com a √°rea de conte√∫do principal.
         */
        function ajustarPosicaoLogo() {
            const logo = document.querySelector('.logo-pequena');
            const header = document.querySelector('header');
            const bar = document.querySelector('.header-background-bar');

            if (!logo || !header || !bar) return;

            // O CSS j√° garante o max-width e a centraliza√ß√£o
            if (window.innerWidth > 480) {
                 // Configura√ß√µes Desktop: garante a centraliza√ß√£o de elementos fixos
                 logo.style.left = '50%';
                 logo.style.transform = 'translateX(-50%)'; 
                 
                 if(bar) {
                     bar.style.left = '50%';
                     bar.style.transform = 'translateX(-50%)';
                 }

            } else {
                // Configura√ß√µes Mobile
                 logo.style.left = '50%';
                 logo.style.transform = 'translateX(-50%)';
                 if(bar) {
                    bar.style.left = '50%';
                    bar.style.transform = 'translateX(-50%)';
                 }
            }
        }

        window.onload = function() {
            // Garante que a logo e o header est√£o posicionados corretamente ao carregar
            ajustarPosicaoLogo();
            // NOVO: Dispara o popup receptivo
            iniciarPopupReceptivo(); 
            // PWA logic is now handled by the 'load' listener inside the script tag
        };
        
        // Adiciona um listener de resize para garantir a corre√ß√£o no desktop
        window.addEventListener('resize', ajustarPosicaoLogo);

    </script>
</body>
</html>
